"use strict";(self.webpackChunkproject=self.webpackChunkproject||[]).push([[417],{3417:function(I,E,a){a.d(E,{b:function(){return B}});var O=a(5671),P=a(3144),e=a(5542),v=a(4942),y=a(311),b=a(7355),c=a(2107),x=a(7106),D=a(2473),T=a(8223),A=a(6702),p=a(9808),g=a(7423);function _(o,l){if(1&o){var r=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(){var S=e.CHM(r).$implicit;return e.oxw().selectedClass=S}),e._UZ(1,"img",7),e.TgZ(2,"div",8),e._uU(3),e.qZA(),e.qZA()}if(2&o){var t=l.$implicit,s=e.oxw();e.ekj("selected",s.selectedClass===t),e.xp6(1),e.MGl("src","assets/img/character/icon/",t,"/head.png",e.LSH),e.xp6(2),e.Oqu(s.getLevel(t))}}var f=function(){var o=function(){function l(r,t,s,d,Z){(0,O.Z)(this,l),this.messageService=r,this.buildStorageService=t,this.buildService=s,this.slormancerSaveParserService=d,this.slormancerCharacterBuilderService=Z,this.HERO_CLASSES=[c.i.Warrior,c.i.Huntress,c.i.Mage],this.created=new e.vpe,this.name="Default name",this.characters=null,this.selectedClass=null}return(0,P.Z)(l,[{key:"parseGameSave",value:function(t){try{var s,d=this.slormancerSaveParserService.parseSaveFile(t);this.characters=((0,v.Z)(s={},c.i.Warrior,this.slormancerCharacterBuilderService.getCharacterFromSave(d,c.i.Warrior)),(0,v.Z)(s,c.i.Huntress,this.slormancerCharacterBuilderService.getCharacterFromSave(d,c.i.Huntress)),(0,v.Z)(s,c.i.Mage,this.slormancerCharacterBuilderService.getCharacterFromSave(d,c.i.Mage)),s),this.selectedClass=null}catch(Z){console.error(Z),this.messageService.error("An error occured while parsing this save file")}}},{key:"getLevel",value:function(t){var s="";return null!==this.characters&&(s=this.characters[t].level.toString()),s}},{key:"createBuild",value:function(){if(null!==this.selectedClass&&null!==this.characters){var t=this.buildService.createBuildWithCharacter(this.name,"New layer",this.characters[this.selectedClass]);this.buildStorageService.addBuild(t),this.created.emit()}}}]),l}();return o.\u0275fac=function(r){return new(r||o)(e.Y36(T.e),e.Y36(y.x),e.Y36(b.d),e.Y36(x.X),e.Y36(D.o))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-build-from-game"]],inputs:{name:"name"},outputs:{created:"created"},decls:9,vars:6,consts:[[1,"import-game"],["label","Upload a Slormancer save file",3,"upload"],[1,"save-summary"],[1,"classes"],["class","head",3,"selected","click",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary",3,"disabled","click"],[1,"head",3,"click"],[3,"src"],[1,"level"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"app-file-upload-button",1),e.NdJ("upload",function(d){return t.parseGameSave(d)}),e.qZA(),e.TgZ(2,"div",2),e.TgZ(3,"p"),e._uU(4,"Choose which character you want to upload"),e.qZA(),e.TgZ(5,"div",3),e.YNc(6,_,4,4,"div",4),e.qZA(),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return t.createBuild()}),e._uU(8,"Create build"),e.qZA(),e.qZA()),2&r&&(e.xp6(2),e.ekj("disabled",null===t.characters),e.xp6(1),e.ekj("disabled",null===t.characters),e.xp6(3),e.Q6J("ngForOf",t.HERO_CLASSES),e.xp6(1),e.Q6J("disabled",null===t.characters||null===t.selectedClass))},directives:[A.Q,p.sg,g.lW],styles:[".import-game[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;grid-gap:12px;gap:12px}.import-game[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin-top:0}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;grid-gap:4px;gap:4px}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:4px;gap:4px;padding-bottom:20px}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{position:relative;border:4px solid black;width:40px;height:40px}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;image-rendering:pixelated;transition:opacity .5s}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;bottom:-20px;width:24px;height:24px;line-height:8px;font-size:12px;text-align:center;border:2px solid black;padding:4px;border-radius:20% 20% 50% 50%;background-color:#353535;transition:opacity .5s;left:50%;transform:translate(-50%)}.import-game[_ngcontent-%COMP%]   .save-summary.disabled[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.1}.import-game[_ngcontent-%COMP%]   .save-summary.disabled[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%], .import-game[_ngcontent-%COMP%]   .save-summary.disabled[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{opacity:0}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]:not(.disabled){cursor:pointer}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]:not(.disabled)   .classes[_ngcontent-%COMP%]   .head.selected[_ngcontent-%COMP%], .import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]:not(.disabled)   .classes[_ngcontent-%COMP%]   .head.selected[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{border-color:#b7b7b7}"]}),o}(),h=a(2846),C=function(){var o=function(){function l(r,t){(0,O.Z)(this,l),this.buildStorageService=r,this.buildService=t,this.created=new e.vpe,this.name="Default name"}return(0,P.Z)(l,[{key:"createBuild",value:function(t){if(null!==t.character){var s=this.buildService.createBuildWithCharacter(this.name,"Imported layer",t.character);this.buildStorageService.addBuild(s),this.created.emit()}else if(null!==t.layer){var d=this.buildService.createBuildWithCharacter(this.name,t.layer.name,t.layer.character);this.buildStorageService.addBuild(d),this.created.emit()}else null!==t.planner&&(this.buildStorageService.addBuild(t.planner),this.created.emit())}}]),l}();return o.\u0275fac=function(r){return new(r||o)(e.Y36(y.x),e.Y36(b.d))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-build-from-export"]],inputs:{name:"name"},outputs:{created:"created"},decls:2,vars:0,consts:[[1,"import-game"],["uploadLabel","Upload an exported file","importLabel","Create build",3,"import"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"app-import-data",1),e.NdJ("import",function(d){return t.createBuild(d)}),e.qZA(),e.qZA())},directives:[h.M],styles:["input[type=file][_ngcontent-%COMP%]{display:none}.import-game[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;grid-gap:12px;gap:12px}.import-game[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin-top:0}"]}),o}();function n(o,l){if(1&o){var r=e.EpF();e.TgZ(0,"div",5),e.NdJ("click",function(){var S=e.CHM(r).$implicit;return e.oxw().selectedClass=S}),e._UZ(1,"img",6),e.qZA()}if(2&o){var t=l.$implicit,s=e.oxw();e.ekj("selected",s.selectedClass===t),e.xp6(1),e.MGl("src","assets/img/character/icon/",t,"/head.png",e.LSH)}}var m=function(){var o=function(){function l(r,t){(0,O.Z)(this,l),this.buildService=r,this.buildStorageService=t,this.HERO_CLASSES=[c.i.Warrior,c.i.Huntress,c.i.Mage],this.created=new e.vpe,this.name="Default name",this.selectedClass=null}return(0,P.Z)(l,[{key:"createBuild",value:function(){if(null!==this.selectedClass){var t=this.buildService.createBuild(this.selectedClass,this.name);this.buildService.addLayer(t,this.name),this.buildStorageService.addBuild(t),this.created.emit()}}}]),l}();return o.\u0275fac=function(r){return new(r||o)(e.Y36(b.d),e.Y36(y.x))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-build-empty"]],inputs:{name:"name"},outputs:{created:"created"},decls:8,vars:2,consts:[[1,"import-game"],[1,"save-summary"],[1,"classes"],["class","head",3,"selected","click",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary",3,"disabled","click"],[1,"head",3,"click"],[3,"src"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"p"),e._uU(3,"Choose which character you want to build"),e.qZA(),e.TgZ(4,"div",2),e.YNc(5,n,2,3,"div",3),e.qZA(),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return t.createBuild()}),e._uU(7,"Create build"),e.qZA(),e.qZA()),2&r&&(e.xp6(5),e.Q6J("ngForOf",t.HERO_CLASSES),e.xp6(1),e.Q6J("disabled",null===t.selectedClass))},directives:[p.sg,g.lW],styles:["input[type=file][_ngcontent-%COMP%]{display:none}.import-game[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;grid-gap:12px;gap:12px}.import-game[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin-top:0}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;grid-gap:4px;gap:4px}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:4px;gap:4px;padding-bottom:20px}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{position:relative;border:4px solid black;width:40px;height:40px}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;image-rendering:pixelated;transition:opacity .5s}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]   .classes[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .level[_ngcontent-%COMP%]{position:absolute;bottom:-20px;width:16px;height:16px;line-height:14px;text-align:center;border:2px solid black;padding:4px;border-radius:20% 20% 50% 50%;background-color:#353535;transition:opacity .5s;left:50%;transform:translate(-50%)}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]:not(.disabled){cursor:pointer}.import-game[_ngcontent-%COMP%]   .save-summary[_ngcontent-%COMP%]:not(.disabled)   .classes[_ngcontent-%COMP%]   .head.selected[_ngcontent-%COMP%]{border-color:#b7b7b7}"]}),o}(),u=a(7322),i=a(7531),M=a(3075),B=function(){var o=function(){function l(){(0,O.Z)(this,l),this.created=new e.vpe,this.buildName="My build"}return(0,P.Z)(l,[{key:"passCreatedEvent",value:function(){this.created.emit()}}]),l}();return o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-build"]],outputs:{created:"created"},decls:16,vars:4,consts:[[3,"name","created"],["appearance","outline","color","primary",1,"no-error-padding"],["matInput","","type","text",3,"ngModel","ngModelChange"]],template:function(r,t){1&r&&(e.TgZ(0,"h3"),e._uU(1,"Create build from a Slormancer save file"),e.qZA(),e.TgZ(2,"app-create-build-from-game",0),e.NdJ("created",function(){return t.passCreatedEvent()}),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"h3"),e._uU(5,"Create build from exported data"),e.qZA(),e.TgZ(6,"app-create-build-from-export",0),e.NdJ("created",function(){return t.passCreatedEvent()}),e.qZA(),e._UZ(7,"hr"),e.TgZ(8,"h3"),e._uU(9,"Create empty build"),e.qZA(),e.TgZ(10,"app-create-build-empty",0),e.NdJ("created",function(){return t.passCreatedEvent()}),e.qZA(),e._UZ(11,"hr"),e.TgZ(12,"mat-form-field",1),e.TgZ(13,"mat-label"),e._uU(14,"Build name"),e.qZA(),e.TgZ(15,"input",2),e.NdJ("ngModelChange",function(d){return t.buildName=d}),e.qZA(),e.qZA()),2&r&&(e.xp6(2),e.Q6J("name",t.buildName),e.xp6(4),e.Q6J("name",t.buildName),e.xp6(4),e.Q6J("name",t.buildName),e.xp6(5),e.Q6J("ngModel",t.buildName))},directives:[f,C,m,u.KE,u.hX,i.Nt,M.Fj,M.JJ,M.On],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}hr[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px}"]}),o}()},6702:function(I,E,a){a.d(E,{Q:function(){return A}});var O=a(5671),P=a(3144),e=a(5542),v=a(5581),y=a(8223),b=a(7423),c=a(9808),x=a(3874);function D(p,g){if(1&p&&(e.ynx(0),e.TgZ(1,"mat-icon"),e._uU(2,"file_upload"),e.qZA(),e._uU(3),e.BQk()),2&p){var _=e.oxw();e.xp6(3),e.Oqu(_.label)}}function T(p,g){1&p&&(e.ynx(0),e.TgZ(1,"mat-icon",4),e._uU(2,"sync"),e.qZA(),e._uU(3,"Uploading..."),e.BQk())}var A=function(){var p=function(){function g(_){(0,O.Z)(this,g),this.messageService=_,this.MAX_UPLOAD_FILE_SIZE_MO=1,this.MAX_UPLOAD_FILE_SIZE=1048576*this.MAX_UPLOAD_FILE_SIZE_MO,this.label=null,this.upload=new e.vpe,this.busy=!1,this.parsing=!1}return(0,P.Z)(g,[{key:"uploadFile",value:function(f){return new Promise(function(h,C){var n=new FileReader;n.onerror=function(){n=null,C()},n.onloadend=function(){null!==n&&null!==n.result&&(h(n.result.toString()),n=null)},n.readAsText(f)})}},{key:"startUpload",value:function(f){var h=this,C=f.target;if(null!==C&&!this.busy){var n=C.files,m=null===n?null:(0,v.lA)(n[0]);null!==m&&(m.size<=this.MAX_UPLOAD_FILE_SIZE?(this.busy=!0,this.uploadFile(m).then(function(u){h.upload.emit(u),C.value="",h.busy=!1},function(){C.value="",h.messageService.error("Failed to upload this file"),h.busy=!1})):this.messageService.error("Cannot upload files bigger than "+this.MAX_UPLOAD_FILE_SIZE_MO+"Mo"))}}}]),g}();return p.\u0275fac=function(_){return new(_||p)(e.Y36(y.e))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-file-upload-button"]],inputs:{label:"label"},outputs:{upload:"upload"},decls:5,vars:2,consts:[["type","file",3,"change"],["fileInput",""],["mat-flat-button","","color","primary",3,"click"],[4,"ngIf"],[1,"animation-rotation"]],template:function(_,f){if(1&_){var h=e.EpF();e.TgZ(0,"input",0,1),e.NdJ("change",function(n){return f.startUpload(n)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return e.CHM(h),e.MAs(1).click()}),e.YNc(3,D,4,1,"ng-container",3),e.YNc(4,T,4,0,"ng-container",3),e.qZA()}2&_&&(e.xp6(3),e.Q6J("ngIf",!f.busy),e.xp6(1),e.Q6J("ngIf",f.busy))},directives:[b.lW,c.O5,x.Hw],styles:["input[type=file][_ngcontent-%COMP%]{display:none}button[_ngcontent-%COMP%]{width:100%}"]}),p}()},2846:function(I,E,a){a.d(E,{M:function(){return C}});var O=a(5671),P=a(3144),e=a(5542),v=a(3075),y=a(8271),b=a(6702),c=a(7322),x=a(7531),D=a(9808),T=a(7423);function A(n,m){1&n&&(e.TgZ(0,"mat-hint",8),e._uU(1,"Paste here a save, build, layer or link"),e.qZA())}function p(n,m){1&n&&(e.TgZ(0,"mat-hint",8),e._uU(1,"Paste here a build, layer or link"),e.qZA())}function g(n,m){1&n&&(e.TgZ(0,"mat-hint",9),e._uU(1,"Character found"),e.qZA())}function _(n,m){1&n&&(e.TgZ(0,"mat-hint",9),e._uU(1,"Layer found"),e.qZA())}function f(n,m){1&n&&(e.TgZ(0,"mat-hint",9),e._uU(1,"Build found"),e.qZA())}function h(n,m){1&n&&(e.TgZ(0,"mat-hint",10),e._uU(1,"No valid data found"),e.qZA())}var C=function(){var n=function(){function m(u){var i=this;(0,O.Z)(this,m),this.importExportService=u,this.MAX_UPLOAD_FILE_SIZE_MO=1,this.MAX_UPLOAD_FILE_SIZE=1048576*this.MAX_UPLOAD_FILE_SIZE_MO,this.uploadLabel=null,this.importLabel=null,this.heroClass=null,this.import=new e.vpe,this.sharedData=null,this.importContent=new v.NI(null,v.kI.maxLength(this.MAX_UPLOAD_FILE_SIZE)),this.importContent.valueChanges.subscribe(function(M){null===M||0===M.length?i.sharedData=null:i.parseExportedData(M)})}return(0,P.Z)(m,[{key:"parseExportedData",value:function(i){this.sharedData=this.importExportService.import(i,this.heroClass),console.log("parse exported data : ",this.sharedData)}},{key:"hasValidSharedData",value:function(){return null!==this.sharedData&&(null!==this.sharedData.character&&(null===this.heroClass||this.sharedData.character.heroClass===this.heroClass)||null!==this.sharedData.layer&&(null===this.heroClass||this.sharedData.layer.character.heroClass===this.heroClass)||null!==this.sharedData.planner&&(null===this.heroClass||this.sharedData.planner.heroClass===this.heroClass))}},{key:"upload",value:function(i){this.importContent.setValue(i)}},{key:"importData",value:function(){null!==this.sharedData&&(this.import.emit(this.sharedData),this.importContent.setValue(""),this.sharedData=null)}}]),m}();return n.\u0275fac=function(u){return new(u||n)(e.Y36(y.s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-import-data"]],inputs:{uploadLabel:"uploadLabel",importLabel:"importLabel",heroClass:"heroClass"},outputs:{import:"import"},decls:16,vars:11,consts:[[1,"import"],[3,"label","upload"],["appearance","outline","color","primary","floatLabel","never"],["matInput","",3,"formControl"],["align","end",4,"ngIf"],["align","end","class","success",4,"ngIf"],["align","end","class","error",4,"ngIf"],["mat-flat-button","","color","primary",3,"disabled","click"],["align","end"],["align","end",1,"success"],["align","end",1,"error"]],template:function(u,i){1&u&&(e.TgZ(0,"div",0),e.TgZ(1,"app-file-upload-button",1),e.NdJ("upload",function(B){return i.upload(B)}),e.qZA(),e.TgZ(2,"mat-form-field",2),e.TgZ(3,"mat-label"),e._uU(4,"Import content..."),e.qZA(),e._UZ(5,"textarea",3),e.YNc(6,A,2,0,"mat-hint",4),e.YNc(7,p,2,0,"mat-hint",4),e.YNc(8,g,2,0,"mat-hint",5),e.YNc(9,_,2,0,"mat-hint",5),e.YNc(10,f,2,0,"mat-hint",5),e.YNc(11,h,2,0,"mat-hint",6),e.TgZ(12,"mat-error"),e._uU(13),e.qZA(),e.qZA(),e.TgZ(14,"button",7),e.NdJ("click",function(){return i.importData()}),e._uU(15),e.qZA(),e.qZA()),2&u&&(e.xp6(1),e.Q6J("label",i.uploadLabel),e.xp6(4),e.Q6J("formControl",i.importContent),e.xp6(1),e.Q6J("ngIf",null===i.sharedData&&null!==i.heroClass),e.xp6(1),e.Q6J("ngIf",null===i.sharedData&&null===i.heroClass),e.xp6(1),e.Q6J("ngIf",null!==i.sharedData&&i.hasValidSharedData()&&null!==i.sharedData.character),e.xp6(1),e.Q6J("ngIf",null!==i.sharedData&&i.hasValidSharedData()&&null!==i.sharedData.layer),e.xp6(1),e.Q6J("ngIf",null!==i.sharedData&&i.hasValidSharedData()&&null!==i.sharedData.planner),e.xp6(1),e.Q6J("ngIf",null!==i.sharedData&&!i.hasValidSharedData()),e.xp6(2),e.hij("Cannot parse files bigger than ",i.MAX_UPLOAD_FILE_SIZE_MO,"Mo"),e.xp6(1),e.Q6J("disabled",!i.hasValidSharedData()),e.xp6(1),e.Oqu(i.importLabel))},directives:[b.Q,c.KE,c.hX,x.Nt,v.Fj,v.JJ,v.oH,D.O5,c.TO,T.lW,c.bx],styles:[".import[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;grid-gap:12px;gap:12px;width:100%}.import[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:60px;max-height:60px}"]}),n}()}}]);